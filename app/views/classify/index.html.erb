
<style>
  directions{
    font-size: 34px;
  }
</style>

<script type="text/javascript">

    var inprogress = false;
    var startx = 0;
    var starty = 0;

    function do_click(){
        $('#linkto')[0].click();
        var box = $('.lb-nav')[0];
        box.id = 'pbox';

        $('#pbox').click(function(pos) {
            startx = pos.clientX;
            starty = pos.clientY;

            document.addEventListener("mousemove", function(ev){
                if (inprogress == true){
                    return;
                }
                console.log(ev.clientX);
                console.log(ev.clientY);
                console.log('');

                var pos = $("#pbox").offset(); // returns an object with the attribute top and left
                left_boundary = pos.left;
                right_boundary = pos.left + $("#pbox").width();
                bottom_boundary = pos.top + $("#pbox").height();
                top_boundary = pos.top;

                console.log('left: ' + left_boundary + ' right ' + right_boundary + ' bottom' + bottom_boundary);

                if (ev.clientX < left_boundary) {
                    inprogress = true;
                    $("#up").val("0");
                    $("#form").submit();
                    return;
                }

                if (ev.clientX > right_boundary) {
                    inprogress = true;
                    $("#right").val("1");
                    $("form").submit();
                    return;
                }

                if (ev.clientY > bottom_boundary) {
                    inprogress = true;
                    $("#down").val("2");
                    $("form").submit();
                    return;
                }

                if (ev.clientY < top_boundary) {
                    inprogress = true;
                    $("#up").val("0");
                    $("form").submit();
                    return;
                }
            });
        });
    }

    $( document ).ready(function() {
        if ($("#go_back").val() == '1'){
            if (localStorage.getItem('reloaded') != 'true'){
                localStorage.setItem('reloaded', 'true');
                location.href = '/classify'
            }
            else{
                localStorage.setItem('reloaded', 'false');
                do_click()
            }
        }
        else{
            do_click()
        }
    });

    $(document).keydown(function(e) {
        console.log(e.which);
        switch(e.which) {
            case 38: // up
                $("#up").val("0");
                $("form").submit();

            case 39:
                $("#right").val("1");
                $("form").submit();

            case 40: // down
                $("#down").val("2");
                $("form").submit();

            default: return; // exit this handler for other keys
        }
        e.preventDefault(); // prevent the default action (scroll / move caret)
    });
</script>

<directions>  <%= @c1 %> <-----------</directions>

<%= link_to(image_tag(attachment_url(@photos.first, :image, :fit, 100, 100, format: 'jpg'), id: 'priyen-img', name: @photos.first.image_id, class: "main-img"), attachment_url(@photos.first, :image, :fit, 500, 500, format: 'jpg'), data: { lightbox: "example-set", title: @photos.first.name }, id: 'linkto') %>

<directions> -----------> <%= @c2 %></directions>

<h1><%= @c3 %></h1>

<%= form_tag("/classify_image", method: "post") do %>
  <%= hidden_field_tag(:image_id, @photos.first.image_id) %>
  <%= hidden_field_tag(:up, '') %>
  <%= hidden_field_tag(:right, '') %>
  <%= hidden_field_tag(:down, '') %>
  <%= hidden_field_tag(:go_back, @go_back) %>
  <%= submit_tag("", :type => 'hidden') %>
<% end %>